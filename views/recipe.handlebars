<!-- Search form -->
<form id="searchForm" action="/api/recipe" method="GET">
    <input id="searchInput" type="text" name="q" placeholder="Search for a recipe">
    <input id="nextPageHref" type="hidden" name="nextHref" value="{{this.nextHref}}"> <!-- This is the hidden input that will store the nextHref -->
    <button id="searchButton" type="submit" value="Search">Search</button>
</form>

<!-- Creates cards for each recipe -->
<div id="recipeCards">
    {{#each recipes}}
        <div class="card">
            <img src="{{this.image}}" alt="{{this.label}}">
            <h2 class="card">{{this.title}}</h2>
            <a href="{{this.url}}" target="_blank">View Recipe</a>
            <p class="ingredients">Ingredients:</p>
            <ol class="ingredientLines">
                {{#each this.ingredientLines}}
                    <li>{{this}}</li>
                {{/each}}
            </ol>
            <button class="save-recipe" data-recipe-id="{{this.id}}">Save Recipe</button>
            <button class="save-ingredients" data-recipe-id="{{this.id}}">Save Ingredients</button>
        </div>
    {{/each}}

    {{#if this.nextHref}}
    <button id="nextPage">Next Page</button>
    {{/if}}
</div>

<script>
    const form = document.getElementById('searchForm');
    const nextButton = document.getElementById('nextPage');

    nextButton.addEventListener('click', (e) => {
        e.preventDefault();
        form.submit();
    });

    
document.addEventListener('DOMContentLoaded', function() {
    var saveRecipeButton = document.querySelector('.save-recipe');
    if (saveRecipeButton) {
        saveRecipeButton.addEventListener('click', function() {
            var recipeId = this.getAttribute('data-recipe-id');
            fetch('/api/recipesave', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ id: recipeId }),
            })
            .then(response => response.json())
            .then(data => alert(data.message))
            .catch(error => console.error('Error:', error));
        });
    }
});



</script>